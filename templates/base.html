{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    {% block meta %}
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>The Coffe Co</title>
    {% endblock %}

    {% block extra_meta %}
    {% endblock %}

    <title>The Coffee Co {% block extra_title %}{% endblock %}</title>

    {% block corecss %}
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="{% static 'css/materialize.css' %}" type="text/css" rel="stylesheet" media="screen,projection" />
    <link rel="stylesheet" href="{% static 'css/style.css' %}" />
    {% endblock %}

    {% block extra_css %}
    {% endblock %}


    {% block corejs %}
    <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <script src="{% static 'js/materialize.js' %}"></script>
    <script src="{% static 'js/init.js' %}"></script>
    {% endblock %}

    {% block extra_js %}
    {% endblock %}

</head>

<body id="body">
    <header>
        <!-- Nar Bar -->
        <nav class="white" role="navigation">
            <div class="nav-wrapper container">
                <a id="logo-container" href="{% url 'home' %}" class="brand-logo">The Coffee Co</a>
                <ul class="right hide-on-med-and-down">
                    <li>
                        <a class='dropdown-trigger1' href='#' data-target='dropdown1'>My Account</a>
                        <ul id='dropdown1' class='dropdown-content'>
                            {% if request.user.is_authenticated %}
                            {% if request.user.is_superuser %}
                            <a href="" class="dropdown-item">Product Management</a>
                            {% endif %}
                            <a href="" class="dropdown-item">My Profile</a>
                            <a href="{% url 'account_logout' %}" class="dropdown-item">Logout</a>
                            {% else %}
                            <a href="{% url 'account_signup' %}" class="dropdown-item">Register</a>
                            <a href="{% url 'account_login' %}" class="dropdown-item">Login</a>
                            {% endif %}
                        </ul>
                    </li>
                    <li>
                        <a class='dropdown-trigger2' href='#' data-target='dropdown2'>Products</a>
                        <ul id='dropdown2' class='dropdown-content'>
                            <li><a href="{% url 'products' %}?sort=price&direction=asc" class="dropdown-item">By
                                    Price</a></li>
                            <li><a href="{% url 'products' %}?sort=category&direction=asc" class="dropdown-item">By
                                    Category</a></li>
                            <li><a href="{% url 'products' %}" class="dropdown-item">All Products</a></li>

                        </ul>
                    </li>
                    <li><a href="{% url 'products' %}?category=fresh_coffee">Fresh Coffee</a></li>
                    <li><a href="{% url 'products' %}?category=machines">Coffee Machines</a></li>
                    <li><a href="{% url 'products' %}?category=accessories">Accessories</a></li>
                    <li>
                        <a class="modal-trigger" href="#modal1"><i class="material-icons">search</i></a>
                        <div id="modal1" class="modal">
                            <nav>
                                <div class="nav-wrapper">
                                    <form method="GET" action="{% url 'products' %}">
                                        <div class="input-field">
                                            <input id="search" type="search" type="text" name="q" required>
                                            <label class="label-icon" for="search"><i
                                                    class="material-icons">search</i></label>
                                            <i class="material-icons">close</i>
                                        </div>
                                    </form>
                                </div>
                            </nav>
                    </li>
                    <li> <i class="material-icons">local_grocery_store</i></li>
                    <li><a href=""> {% if grand_total %}
                            £{{ grand_total|floatformat:2 }}
                            {% else %}
                            £0.00
                            {% endif %}</a></li>
                </ul>
                <ul id="nav-mobile" class="sidenav">
                    <li>
                        <a class='dropdown-trigger3' href='#' id="user-options" data-target='dropdown3'>My Account</a>
                        <ul id='dropdown3' class='dropdown-content'>
                            {% if request.user.is_authenticated %}
                            {% if request.user.is_superuser %}
                            <a href="" class="dropdown-item">Product Management</a>
                            {% endif %}
                            <a href="" class="dropdown-item">My Profile</a>
                            <a href="{% url 'account_logout' %}" class="dropdown-item">Logout</a>
                            {% else %}
                            <a href="{% url 'account_signup' %}" class="dropdown-item">Register</a>
                            <a href="{% url 'account_login' %}" class="dropdown-item">Login</a>
                            {% endif %}
                        </ul>
                    </li>
                    <li>
                        <a class='dropdown-trigger4' href='#' data-target='dropdown4'>Products</a>
                        <ul id='dropdown4' class='dropdown-content'>
                            <li><a href="{% url 'products' %}?sort=price&direction=asc" class="dropdown-item">By
                                    Price</a></li>
                            <li><a href="{% url 'products' %}?sort=category&direction=asc" class="dropdown-item">By
                                    Category</a></li>
                            <li><a href="{% url 'products' %}" class="dropdown-item">All Products</a></li>
                        </ul>
                    </li>
                    <li><a href="{% url 'products' %}?category=fresh_coffee">Fresh Coffee</a></li>
                    <li><a href="{% url 'products' %}?category=machines">Coffee Machines</a></li>
                    <li><a href="{% url 'products' %}?category=accessories">Accessories</a></li>
                    <li>
                        <div class="modal2">
                            <nav>
                                <div class="nav-wrapper">
                                    <form method="GET" action="{% url 'products' %}">
                                        <div class="input-field">
                                            <input id="search" type="search" type="text" name="q" required>
                                            <label class="label-icon" for="search"><i
                                                    class="material-icons">search</i></label>
                                            <i class="material-icons">close</i>
                                        </div>
                                    </form>
                                </div>
                            </nav>
                    </li>
                    <li><a href=""> {% if grand_total %}
                            £{{ grand_total|floatformat:2 }}
                            {% else %}
                            £0.00
                            {% endif %}</a></li>
                </ul>
                <a href="#" data-target="nav-mobile" class="sidenav-trigger"><i class="material-icons">menu</i></a>
            </div>
        </nav>
    </header>

    {% if messages %}
    <div></div>
    {% endif %}

    {% block page_header %}
    {% endblock %}

    {% block content %}
    {% endblock %}

    {% block postloadjs %}
    {% endblock %}

    <!-- Footer -->
    <footer class="page-footer grey darken-3">
        <div class="container">
            <div class="row">
                <div class="col l6 s12">
                    <h5 class="white-text">Company Address</h5>
                    <p class="grey-text text-lighten-4">We are a team of college students working on this project like
                        it's our full time job. Any amount would help support and continue development on this project
                        and is greatly appreciated.</p>
                </div>
            </div>
        </div>
        <div class="footer-copyright grey darken-3">
            <div class="container">
            </div>
        </div>
    </footer>
</body>
<script>
    $(document).ready(function () {
        $('.modal').modal();
    });
    $('.dropdown-trigger1').dropdown();
    $('.dropdown-trigger2').dropdown();
    $('.dropdown-trigger3').dropdown();
    $('.dropdown-trigger4').dropdown();
    $(document).ready(function(){
    $('select').formSelect();  
  });

  $('#sort-selector').change(function() {
            var selector = $(this);
            var currentUrl = new URL(window.location);

            var selectedVal = selector.val();
            if(selectedVal != "reset"){
                var sort = selectedVal.split("_")[0];
                var direction = selectedVal.split("_")[1];

                currentUrl.searchParams.set("sort", sort);
                currentUrl.searchParams.set("direction", direction);

                window.location.replace(currentUrl);
            } else {
                currentUrl.searchParams.delete("sort");
                currentUrl.searchParams.delete("direction");

                window.location.replace(currentUrl);
            }
        })
</script>

</html>